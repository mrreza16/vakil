<!DOCTYPE html>
<html>
<head>
            <style>/* استایل‌های عمومی */
body {
    font-family: Arial, sans-serif;
    direction: rtl;
    padding: 20px;
    background-color: #f4f4f4;
    margin: 0;
}

.container {
    max-width: 800px;
    margin: 0 auto;
    background: #fff;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
}

h1 {
    text-align: center;
    color: #333;
    margin-bottom: 20px;
    font-size: 24px;
}

/* استایل‌های فرم */
form {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.form-row {
    display: flex;
    gap: 0.5cm;
    margin-bottom: 15px;
}

.form-group {
    flex: 1;
    display: flex;
    flex-direction: column;
    margin: 0 0.25cm;
}

label {
    display: block;
    margin-bottom: 5px;
    color: #555;
    font-weight: bold;
}

input, select, textarea {
    width: calc(100% - 1cm);
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 14px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
}

input:focus, select:focus, textarea:focus {
    border-color: #28a745;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    outline: none;
}

/* استایل‌های دکمه‌ها */
.button-row {
    display: flex;
    gap: 0.5cm;
    margin-top: 15px;
}

button {
    flex: 1;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    background: linear-gradient(145deg, #28a745, #218838);
    color: white;
    cursor: pointer;
    font-size: 14px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
    transition: box-shadow 0.3s ease, transform 0.3s ease;
}

button:hover {
    background: linear-gradient(145deg, #218838, #1e7e34);
    box-shadow: 0 6px 8px rgba(0, 0, 0, 0.3);
    transform: translateY(-2px);
}

button:active {
    transform: translateY(0);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
}

/* استایل‌های بخش جستجو */
.search-section {
    margin-top: 20px;
    padding: 15px;
    background: #f9f9f9;
    border-radius: 8px;
    border: 1px solid #ddd;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.search-row {
    display: flex;
    gap: 10px;
    align-items: center;
}

.navigation-row {
    display: flex;
    gap: 10px;
    align-items: center;
}

.search-row label {
    margin-right: 10px;
}

.search-row select,
.search-row input {
    flex: 1;
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.search-row button {
    padding: 8px 15px;
    background: linear-gradient(145deg, #007bff, #0056b3);
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
}

.search-row button:hover {
    background: linear-gradient(145deg, #0056b3, #004080);
    box-shadow: 0 6px 8px rgba(0, 0, 0, 0.3);
    transform: translateY(-2px);
}

#resultCount {
    flex: 1;
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
    background-color: #f9f9f9;
    text-align: center;
    font-weight: bold;
    color: #333;
}

#prevButton, #nextButton {
    padding: 5px 10px;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
}

#prevButton:disabled, #nextButton:disabled {
    background-color: #ccc;
    cursor: not-allowed;
    box-shadow: none;
}

#prevButton:hover:not(:disabled), #nextButton:hover:not(:disabled) {
    background-color: #0056b3;
    box-shadow: 0 6px 8px rgba(0, 0, 0, 0.3);
}

/* استایل‌های Modal */
.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    justify-content: center;
    align-items: center;
}

.modal-content {
    background-color: #fff;
    padding: 20px;
    border-radius: 10px;
    width: 80%;
    max-width: 300px;
    text-align: center;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.close {
    color: #aaa;
    float: right;
    font-size: 24px;
    font-weight: bold;
    cursor: pointer;
}

.close:hover {
    color: #000;
}

#callButton, #smsButton {
    padding: 10px 20px;
    margin: 10px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 16px;
    color: white;
    transition: background-color 0.3s ease;
}

#callButton {
    background-color: #28a745;
}

#smsButton {
    background-color: #007bff;
}

#callButton:hover {
    background-color: #218838;
}

#smsButton:hover {
    background-color: #0056b3;
}

/* استایل‌های منوی آبشاری */
.dropdown-container {
    position: relative;
    width: 100%;
}

.dropdown-input {
    width: calc(100% - 1cm);
    padding: 10px 30px 10px 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 14px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    background-color: #fff;
    cursor: pointer;
    resize: none;
    overflow: hidden;
    white-space: nowrap;
}

.dropdown-arrow {
    position: absolute;
    top: 50%;
    left: 10px;
    transform: translateY(-50%);
    font-size: 12px;
    color: #555;
    cursor: pointer;
    display: none;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    max-height: 200px;
    border: 1px solid #ccc;
    border-radius: 5px;
    background-color: #fff;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    display: none;
    z-index: 1000;
    overflow-y: auto;
}

.dropdown-menu div {
    padding: 10px;
    cursor: pointer;
    border-bottom: 1px solid #eee;
}

.dropdown-menu div:last-child {
    border-bottom: none;
}

.dropdown-menu div:hover {
    background-color: #f0f0f0;
}</style>
        <style id="mttstyle">
    #mttContainer {
      left: 0 !important;
      top: 0 !important;
      width: 1000px !important;
      margin: 0px !important;
      margin-left: -500px !important;
      position: fixed !important;
      z-index: 100000200 !important;
      background: none !important;
      pointer-events: none !important;
      display: inline-block !important;
      visibility: visible  !important;
      white-space: pre-line;
    }
    .tippy-box[data-theme~="custom"], .tippy-content *{
      font-size: 18px  !important;
      text-align: center !important;
      overflow-wrap: break-word !important;
      color: #ffffffff !important;
      font-family: 
        -apple-system, BlinkMacSystemFont,
        "Segoe UI", "Roboto", "Oxygen",
        "Ubuntu", "Cantarell", "Fira Sans",
        "Droid Sans", "Helvetica Neue", sans-serif  !important;
      white-space: pre-line;
    }
    .tippy-box[data-theme~="custom"]{
      max-width: 200px  !important;
      backdrop-filter: blur(6px) !important;
      background-color: #00000080 !important;
      border: 1px solid #ffffff00; 
      box-shadow: rgba(50, 50, 93, 0.25) 0px 2px 5px -1px, rgba(0, 0, 0, 0.3) 0px 1px 3px -1px;
    }
    [data-tippy-root] {
      display: inline-block !important;
      visibility: visible  !important;
      position: absolute !important;
    }
    .tippy-box[data-theme~='custom'][data-placement^='top'] > .tippy-arrow::before { 
      border-top-color: #00000080 !important;
    }
    .tippy-box[data-theme~='custom'][data-placement^='bottom'] > .tippy-arrow::before {
      border-bottom-color: #00000080 !important;
    }
    .tippy-box[data-theme~='custom'][data-placement^='left'] > .tippy-arrow::before {
      border-left-color: #00000080 !important;
    }
    .tippy-box[data-theme~='custom'][data-placement^='right'] > .tippy-arrow::before {
      border-right-color: #00000080 !important;
    }
    .mtt-highlight{
      background-color: #21dc6d40  !important;
      position: absolute !important;   
      z-index: 100000100 !important;
      pointer-events: none !important;
      display: inline !important;
      border-radius: 3px !important;
    }
    .mtt-image{
      width: 180px  !important;
      border-radius: 3px !important;
    }
    .ocr_text_div{
      position: absolute;
      opacity: 0.5;
      color: transparent !important;
      border: 2px solid CornflowerBlue;
      background: none !important;
      border-radius: 3px !important;
    }</style><style id="mttstyleSubtitle">
    #ytp-caption-window-container .ytp-caption-segment {
      cursor: text !important;
      user-select: text !important;
      font-family: 
      -apple-system, BlinkMacSystemFont,
      "Segoe UI", "Roboto", "Oxygen",
      "Ubuntu", "Cantarell", "Fira Sans",
      "Droid Sans", "Helvetica Neue", sans-serif  !important;
    }
    .caption-visual-line{
      display: flex  !important;
      align-items: stretch  !important;
    }
    .captions-text .caption-visual-line:first-of-type:after {
      content: '⣿⣿';
      border-radius: 3px !important;
      color: white !important;
      background: transparent !important;
      box-shadow: rgba(50, 50, 93, 0.25) 0px 30px 60px -12px inset, rgba(0, 0, 0, 0.3) 0px 18px 36px -18px inset;
      display: inline-block;
      vertical-align: top;
      opacity:0;
      transition: opacity 0.7s ease-in-out;
    }
    .ytp-caption-segment{
      color: white !important;
      text-shadow: 1px 1px 2px black !important;
      background:transparent  !important;
    }
    .captions-text:hover .caption-visual-line:first-of-type:after {
      opacity:1;
    }
    .ytp-pause-overlay {
      display: none !important;
    }
    .ytp-expand-pause-overlay .caption-window {
      display: block !important;
    }
  </style></head>
        <body>
            


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ثبت اطلاعات ابلاغیه</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jalaali-js/dist/jalaali.js"></script>


    <div class="container">
        <h1>ثبت اطلاعات ابلاغیه</h1>
        <form id="form">
            <!-- ردیف اول: دو فیلد -->
            <div class="form-row">
                <div class="form-group">
                    <label for="type">نوع قرار:</label>
                    <select id="type" name="type">
                        <option value="">انتخاب کنید</option>
                        <option value="کارشناسی">کارشناسی</option>
                        <option value="تامین دلیل">تامین دلیل</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="date">تاریخ ابلاغیه:</label>
                    <input type="text" id="date" name="date" placeholder="yyyy/mm/dd">
                </div>
            </div>

            <!-- ردیف دوم: دو فیلد -->
            <div class="form-row">
                <div class="form-group">
                    <label for="courtType">بدوی یا تکمیلی:</label>
                    <select id="courtType" name="courtType">
                        <option value="">انتخاب کنید</option>
                        <option value="بدوی">بدوی</option>
                        <option value="تکمیلی">تکمیلی</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="individualOrPanel">انفرادی-هیأت:</label>
                    <select id="individualOrPanel" name="individualOrPanel">
                        <option value="">انتخاب کنید</option>
                        <option value="انفرادی">انفرادی</option>
                        <option value="هیأت">هیأت</option>
                    </select>
                </div>
            </div>

            <!-- ردیف سوم: دو فیلد -->
            <div class="form-row">
                <div class="form-group">
                    <label for="city">شهر:</label>
                    <select id="city" name="city">
                        <option value="">انتخاب کنید</option>
                        <option value="زنجان">زنجان</option>
                        <option value="ابهر">ابهر</option>
                        <option value="خرمدره">خرمدره</option>
                        <option value="خدابنده">خدابنده</option>
                        <option value="ماهنشان">ماهنشان</option>
                        <option value="طارم">طارم</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="courtCategory">نوع دادگاه:</label>
                    <select id="courtCategory" name="courtCategory">
                        <option value="">انتخاب کنید</option>
                        <option value="حقوقی">حقوقی</option>
                        <option value="کیفری">کیفری</option>
                        <option value="بازپرسی">بازپرسی</option>
                        <option value="دادیاری">دادیاری</option>
                        <option value="صلح">صلح</option>
                        <option value="تجدیدنظر">تجدیدنظر</option>
                    </select>
                </div>
            </div>

            <!-- ردیف چهارم: شماره شعبه و شماره بایگانی -->
            <div class="form-row">
                <div class="form-group">
                    <label for="branchNumber">شماره شعبه:</label>
                    <input type="text" id="branchNumber" name="branchNumber">
                </div>
                <div class="form-group">
                    <label for="archiveNumber">شماره بایگانی:</label>
                    <input type="text" id="archiveNumber" name="archiveNumber">
                </div>
            </div>

            <!-- سایر فیلدها -->
            <label for="noticeNumber">شماره ابلاغیه:</label>
            <input type="text" id="noticeNumber" name="noticeNumber">

            <label for="caseNumber">شماره پرونده:</label>
            <input type="text" id="caseNumber" name="caseNumber">

            <!-- فیلدهای شماره تلفن با منوی آبشاری -->
            <label for="plaintiff">نام خواهان با شماره تماس:</label>
            <div class="dropdown-container">
                <textarea id="plaintiff" name="plaintiff" class="dropdown-input" rows="1"></textarea>
                <span class="dropdown-arrow">▼</span>
                <div id="plaintiffDropdown" class="dropdown-menu"></div>
            </div>

            <label for="defendant">نام خوانده با شماره تماس:</label>
            <div class="dropdown-container">
                <textarea id="defendant" name="defendant" class="dropdown-input" rows="1"></textarea>
                <span class="dropdown-arrow">▼</span>
                <div id="defendantDropdown" class="dropdown-menu"></div>
            </div>

            <label for="panelMembers">اعضای هیأت کارشناسی با شماره تماس:</label>
            <div class="dropdown-container">
                <textarea id="panelMembers" name="panelMembers" class="dropdown-input" rows="1"></textarea>
                <span class="dropdown-arrow">▼</span>
                <div id="panelMembersDropdown" class="dropdown-menu"></div>
            </div>

            <!-- فیلد تاریخ ارسال گزارش -->
            <label for="reportDate">تاریخ ارسال گزارش:</label>
            <input type="text" id="reportDate" name="reportDate" placeholder="yyyy/mm/dd">

            <!-- فیلد کد رهگیری -->
            <label for="trackingCode">کد رهگیری:</label>
            <input type="text" id="trackingCode" name="trackingCode">

            <!-- سایر فیلدها با منوی آبشاری -->
            <label for="cooperatedExperts">کارشناسان هیأت که همکاری کردند:</label>
            <div class="dropdown-container">
                <textarea id="cooperatedExperts" name="cooperatedExperts" class="dropdown-input" rows="1"></textarea>
                <span class="dropdown-arrow">▼</span>
                <div id="cooperatedExpertsDropdown" class="dropdown-menu"></div>
            </div>

            <label for="nonCooperatedExperts">کارشناسان هیأت که همکاری نکردند:</label>
            <div class="dropdown-container">
                <textarea id="nonCooperatedExperts" name="nonCooperatedExperts" class="dropdown-input" rows="1"></textarea>
                <span class="dropdown-arrow">▼</span>
                <div id="nonCooperatedExpertsDropdown" class="dropdown-menu"></div>
            </div>

            <!-- ردیف پنجم: مبلغ و وضعیت -->
            <div class="form-row">
                <div class="form-group">
                    <label for="amount">مبلغ:</label>
                    <input type="text" id="amount" name="amount">
                </div>
                <div class="form-group">
                    <label for="status">وضعیت:</label>
                    <select id="status" name="status">
                        <option value="">انتخاب کنید</option>
                        <option value="دریافت شده">دریافت شده</option>
                        <option value="دریافت نشده">دریافت نشده</option>
                    </select>
                </div>
            </div>

            <!-- دکمه‌های ثبت، حذف و پاک کردن فرم -->
            <div class="button-row">
                <button type="button" id="saveButton">ثبت اطلاعات</button>
                <button type="button" id="deleteButton">حذف اطلاعات</button>
                <button type="button" id="clearButton">پاک کردن فرم</button>
            </div>
        </form>

        <!-- بخش جستجو -->
        <div class="search-section">
            <!-- سطر اول: فیلد جستجو و دکمه جستجو -->
            <div class="search-row">
                <label for="searchField">جستجو بر اساس:</label>
                <select id="searchField">
                    <option value="type">نوع قرار</option>
                    <option value="date">تاریخ ابلاغیه</option>
                    <option value="courtType">بدوی یا تکمیلی</option>
                    <option value="individualOrPanel">انفرادی-هیأت</option>
                    <option value="city">شهر</option>
                    <option value="courtCategory">نوع دادگاه</option>
                    <option value="branchNumber">شماره شعبه</option>
                    <option value="archiveNumber">شماره بایگانی</option>
                    <option value="noticeNumber">شماره ابلاغیه</option>
                    <option value="caseNumber">شماره پرونده</option>
                    <option value="plaintiff">نام خواهان با شماره تماس</option>
                    <option value="defendant">نام خوانده با شماره تماس</option>
                    <option value="panelMembers">اعضای هیأت کارشناسی با شماره تماس</option>
                    <option value="reportDate">تاریخ ارسال گزارش</option>
                    <option value="trackingCode">کد رهگیری</option>
                    <option value="cooperatedExperts">کارشناسان هیأت که همکاری کردند</option>
                    <option value="nonCooperatedExperts">کارشناسان هیأت که همکاری نکردند</option>
                    <option value="amount">مبلغ</option>
                    <option value="status">وضعیت</option>
                </select>
                <input type="text" id="searchTerm" placeholder="عبارت جستجو را وارد کنید">
                <button type="button" id="searchButton">جستجو</button>
            </div>

            <!-- سطر دوم: تعداد نتایج و دکمه‌های قبلی و بعدی -->
            <div class="navigation-row">
                <input type="text" id="resultCount" placeholder="تعداد نتایج" readonly="">
                <button type="button" id="prevButton" disabled="">قبلی</button>
                <button type="button" id="nextButton" disabled="">بعدی</button>
            </div>
        </div>
    </div>

    <!-- Modal برای انتخاب تماس یا پیامک -->
    <div id="phoneModal" class="modal">
        <div class="modal-content">
            <span class="close">×</span>
            <p id="modalPhoneNumber"></p>
            <button id="callButton">تماس</button>
            <button id="smsButton">ارسال پیامک</button>
        </div>
    </div>

    <script src="script.js"></script>


            <script>let data = [];
let searchResults = [];
let currentIndex = -1;
let isEditing = false; // برای تشخیص حالت ویرایش

// تابع تبدیل اعداد به فرمت تاریخ شمسی
function formatDateInput(input) {
    const value = input.value.replace(/\D/g, ''); // حذف همه کاراکترهای غیرعددی
    if (value.length === 8) {
        const year = value.slice(0, 4);
        const month = value.slice(4, 6);
        const day = value.slice(6, 8);
        input.value = `${year}/${month}/${day}`; // تبدیل به فرمت تاریخ
    } else {
        alert('تاریخ وارد شده نامعتبر است!');
        input.value = ''; // پاک کردن فیلد اگر طول تاریخ نامعتبر باشد
    }
}

// تابع ذخیره یا به‌روزرسانی اطلاعات
function saveData() {
    const form = document.getElementById('form');
    const formData = new FormData(form);
    const entry = {};
    formData.forEach((value, key) => {
        entry[key] = value;
    });

    if (isEditing && currentIndex !== -1 && searchResults[currentIndex]) {
        // به‌روزرسانی رکورد موجود
        const originalRecord = searchResults[currentIndex];
        const indexInData = data.findIndex(record => JSON.stringify(record) === JSON.stringify(originalRecord));
        if (indexInData !== -1) {
            data[indexInData] = entry; // به‌روزرسانی رکورد در داده‌ها
            searchResults[currentIndex] = entry; // به‌روزرسانی رکورد در نتایج جستجو
            alert('اطلاعات با موفقیت به‌روزرسانی شد!');
        }
    } else {
        // ایجاد رکورد جدید
        data.push(entry);
        alert('اطلاعات با موفقیت ثبت شد!');
    }

    form.reset();
    isEditing = false; // حالت ویرایش غیرفعال می‌شود
}

// تابع جستجو
function searchData() {
    const searchField = document.getElementById('searchField').value;
    const searchTerm = document.getElementById('searchTerm').value;

    if (!searchTerm) {
        alert('لطفاً عبارت جستجو را وارد کنید.');
        return;
    }

    searchResults = data.filter(entry => {
        return entry[searchField] && entry[searchField].toString().includes(searchTerm);
    });

    if (searchResults.length === 0) {
        alert('نتیجه‌ای یافت نشد.');
        return;
    }

    currentIndex = 0;
    updateFormWithResult(searchResults[currentIndex]);
    updateNavigationButtons();
    updateResultCount();
    isEditing = true; // فعال کردن حالت ویرایش

    // پاک کردن فیلد جستجو
    document.getElementById('searchTerm').value = '';
}

// تابع نمایش نتیجه در فیلدها
function updateFormWithResult(result) {
    const form = document.getElementById('form');
    for (const key in result) {
        if (form.elements[key]) {
            form.elements[key].value = result[key];
        }
    }
}

// تابع به‌روزرسانی دکمه‌های قبلی و بعدی
function updateNavigationButtons() {
    const prevButton = document.getElementById('prevButton');
    const nextButton = document.getElementById('nextButton');
    prevButton.disabled = currentIndex <= 0;
    nextButton.disabled = currentIndex >= searchResults.length - 1;
}

// تابع به‌روزرسانی تعداد نتایج
function updateResultCount() {
    const resultCount = document.getElementById('resultCount');
    resultCount.value = `تعداد نتایج: ${searchResults.length}`;
}

// تابع حرکت به رکورد قبلی
function prevResult() {
    if (currentIndex > 0) {
        currentIndex--;
        updateFormWithResult(searchResults[currentIndex]);
        updateNavigationButtons();
    }
}

// تابع حرکت به رکورد بعدی
function nextResult() {
    if (currentIndex < searchResults.length - 1) {
        currentIndex++;
        updateFormWithResult(searchResults[currentIndex]);
        updateNavigationButtons();
    }
}

// تابع حذف اطلاعات
function deleteData() {
    if (currentIndex === -1 || searchResults.length === 0) {
        alert('هیچ رکوردی برای حذف یافت نشد.');
        return;
    }

    const currentRecord = searchResults[currentIndex];
    data = data.filter(entry => {
        return JSON.stringify(entry) !== JSON.stringify(currentRecord);
    });

    searchResults.splice(currentIndex, 1); // حذف رکورد از نتایج جستجو

    if (searchResults.length === 0) {
        alert('رکورد حذف شد و دیگر نتیجه‌ای وجود ندارد.');
        document.getElementById('form').reset();
        currentIndex = -1;
    } else {
        currentIndex = Math.min(currentIndex, searchResults.length - 1);
        updateFormWithResult(searchResults[currentIndex]);
    }

    updateNavigationButtons();
    updateResultCount();
}

// تابع پاک کردن فرم
function clearForm() {
    document.getElementById('form').reset();
    alert('فرم با موفقیت پاک شد!');
    isEditing = false; // حالت ویرایش غیرفعال می‌شود
}

// تابع فرمت‌دهی تاریخ شمسی هنگام خروج از فیلد
function formatDateOnBlur(event) {
    const input = event.target;
    formatDateInput(input); // تبدیل اعداد به فرمت تاریخ
}

// مدیریت Modal برای تماس یا پیامک
let currentPhoneNumber = '';

function showPhoneModal(phoneNumber) {
    currentPhoneNumber = phoneNumber;
    const modal = document.getElementById('phoneModal');
    const modalPhoneNumber = document.getElementById('modalPhoneNumber');
    modalPhoneNumber.textContent = `شماره تماس: ${phoneNumber}`;
    modal.style.display = 'block';
}

function closePhoneModal() {
    const modal = document.getElementById('phoneModal');
    modal.style.display = 'none';
}

function makeCall() {
    if (currentPhoneNumber) {
        window.location.href = `tel:${currentPhoneNumber}`;
    }
    closePhoneModal();
}

function sendSms() {
    if (currentPhoneNumber) {
        window.location.href = `sms:${currentPhoneNumber}`;
    }
    closePhoneModal();
}

// تابع استخراج شماره تماس از متن
function extractPhoneNumber(text) {
    const phoneRegex = /(\+98|0)?9\d{9}/g; // الگو برای شماره موبایل ایرانی
    const matches = text.match(phoneRegex);
    return matches ? matches[0] : null;
}

// افزودن رویداد کلیک به فیلدهای مربوط به شماره تماس
document.addEventListener('DOMContentLoaded', () => {
    const phoneFields = ['plaintiff', 'defendant', 'panelMembers'];
    phoneFields.forEach(fieldId => {
        const textarea = document.getElementById(fieldId);
        textarea.addEventListener('click', () => {
            const phoneNumber = extractPhoneNumber(textarea.value);
            if (phoneNumber) {
                showPhoneModal(phoneNumber);
            } else {
                alert('شماره تماس معتبری یافت نشد!');
            }
        });
    });

    // رویدادهای Modal
    document.getElementById('callButton').addEventListener('click', makeCall);
    document.getElementById('smsButton').addEventListener('click', sendSms);
    document.querySelector('.close').addEventListener('click', closePhoneModal);

    // بستن Modal با کلیک خارج از آن
    window.addEventListener('click', (event) => {
        const modal = document.getElementById('phoneModal');
        if (event.target === modal) {
            closePhoneModal();
        }
    });

    // افزودن رویداد blur برای فیلدهای تاریخ
    document.getElementById('date').addEventListener('blur', formatDateOnBlur);
    document.getElementById('reportDate').addEventListener('blur', formatDateOnBlur);

    // رویدادهای دکمه‌ها
    document.getElementById('saveButton').addEventListener('click', saveData);
    document.getElementById('deleteButton').addEventListener('click', deleteData);
    document.getElementById('clearButton').addEventListener('click', clearForm);
    document.getElementById('searchButton').addEventListener('click', searchData);
    document.getElementById('prevButton').addEventListener('click', prevResult);
    document.getElementById('nextButton').addEventListener('click', nextResult);
});</script>
        
    
</body>